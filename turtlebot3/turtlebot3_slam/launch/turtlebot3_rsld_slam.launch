<launch>
  <!-- Arguments -->
  <arg name="model" default="$(env TURTLEBOT3_MODEL)" doc="model type [burger, waffle, waffle_pi]"/>
  <arg name="slam_methods" default="rsld_exploration" doc="slam type [gmapping, cartographer, hector, karto, frontier_exploration, rs_gmapping, rs_exploration]"/>
  <arg name="configuration_basename" default="turtlebot3_lds_2d.lua"/>  
  <arg name="multi_robot_name" default="$(env ROS_NAMESPACE)"/>
  <arg name="resolution" default="0.1"/>
  <arg name="3dresolution" default="0.1"/>
  <arg name="rstopic" default= "rsscan"/>
  <arg name="outputlink" default="rs200_camera"/>
  <arg name="camera" default="camera"/>

  <!-- SLAM: Gmapping, Cartographer, Hector, Karto, Frontier_exploration, RTAB-Map -->
  <include file="$(find turtlebot3_slam)/launch/turtlebot3_$(arg slam_methods).launch">
    <arg name="model" value="$(arg model)"/>
    <arg name="configuration_basename" value="$(arg configuration_basename)"/>
    <arg name="multi_robot_name" value="$(arg multi_robot_name)"/>
    <arg name="resolution" value="$(arg resolution)"/>
   </include>

  <node pkg="depthimage_to_laserscan" type="depthimage_to_laserscan" name="depthimage_to_laserscan">
    <remap from="camera_info" to="$(arg camera)/depth/camera_info" />
    <remap from="image" to="$(arg camera)/depth/image_raw" />
    <remap from="scan" to="$(arg rstopic)" />
    <param name="scan_height" value="0.11"/>
    <param name="output_frame_id" value="$(arg multi_robot_name)/rs200_camera"/>
    <param name="scan_time" value="0.1"/> <!--0.0166 would be 1 scan per 1 depth image-->
    <param name="range_min" value="0.5"/>
    <param name="range_max" value="3.0"/>
  </node>

  <!-- Octomapping-->
  <node pkg="octomap_server" type="octomap_server_node" name="octomap_server">
  <param name="resolution" value="$(arg 3dresolution)" />
		
  <!-- fixed map frame (set to 'map' if SLAM or localization running!) -->
  <param name="frame_id" type="string" value="$(arg multi_robot_name)/map" />
		
  <!-- maximum range to integrate (speedup!) -->
  <param name="sensor_model/max_range" value="3.0" />
		
  <!-- data source to integrate (PointCloud2) -->
  <remap from="cloud_in" to="camera/depth/points" />
</node>
</launch>
